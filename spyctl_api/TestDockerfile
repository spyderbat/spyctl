# 
FROM python:3.11

# 
WORKDIR /code

# 
COPY ./test_requirements.txt /code/requirements.txt
ADD ./build/spyctl /spyctl

RUN apt-get update 
RUN apt-get -y install curl unzip groff less
# AWS CLI installation commands
RUN	curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
RUN	unzip awscliv2.zip && ./aws/install

# 
RUN pip install --no-cache-dir --upgrade -r /code/requirements.txt

COPY ../ /opt/spyderbat/spyctl

# 
COPY ./app /code/app

# 
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "80"]